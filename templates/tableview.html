<!DOCTYPE html>
<html>
    <head>
        <title>{% block title %}CountAi{% endblock %}</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="{{ url_for('static', path='/styles.css') }}" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
    </head>
<body>
    {% include "header.html" %}
    <h1>Teble view</h1>
    <hr>
    <table class="table table-striped">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Mill Name</th>
            <th scope="col">Machine Status</th>
            <th scope="col">UV-Alarm Status</th>
            <th scope="col">Cone-Alarm Status</th>
            <th scope="col">Today's Count</th>
            <th scope="col">Today's UV - Defect</th>
            <th scope="col">Today's ConeTip - Defect</th>
            <th scope="col">Today's UV_Defect %</th>
            <th scope="col">Today's CT_Defect %</th>
            <th scope="col">Last inspection at</th>
          </tr>
        </thead>
        <tbody>
            {% for index, row in mills.iterrows() %}
                <tr>
                    <th style="vertical-align: middle;" scope="row">{{index}}</th>
                    <td style="vertical-align: middle;">{{ row["millName"] }}</td>                      
                    <td>
                        {% if row["lastactive"] <= lh_time %}
                        <img src="{{ url_for('static', path='/Image/material-symbols-mode-off-on-2.svg') }}" class="card-img-top"
                            alt="..." width="40" height="40">
                        {% else %}
                            <img src="{{ url_for('static', path='/Image/material-symbols-mode-off-on-4.svg') }}" class="card-img-top"
                            alt="..." width="40" height="40">
                        {% endif %}
                    </td>
                    <td style="text-align: center; vertical-align: middle;">
                        {% if row["uv_Alrmstatus"] == "off" %}
                            <button type="button" class="btn btn-danger" >
                                Off <span class="badge bg-success"></span>
                        {% else %}
                            <button type="button" class="btn btn-success">
                                ON <span class="badge bg-danger"></span>
                        {% endif %}
                    </td>
                    <td style="text-align: center; vertical-align: middle;">
                        {% if row["tip_Alrmstatus"] == "off" %}
                            <button type="button" class="btn btn-danger">
                                Off <span class="badge bg-success"></span>
                        {% else %}
                            <button type="button" class="btn btn-success">
                                ON <span class="badge bg-danger"></span>
                        {% endif %}
                    </td>
                    <td style="text-align: center; vertical-align: middle;">
                        {{ row["conetip_total"] + row["uv_total"] }}</td>
                    <td style="text-align: center; vertical-align: middle;">
                        {{ row["uv_Defect"] }}</td>
                    <td style="text-align: center; vertical-align: middle;">
                        {{ row["conetip_Defect"] }}</td>
                    <td style="text-align: center; vertical-align: middle;">
                        {{ "%.1f" % row["defectPercen_UV"] }}</td>
                    <td style="text-align: center; vertical-align: middle;">
                        {{ "%.1f" % row["defectPercen_CT"] }}</td>
                    <td style="vertical-align: middle;">{{ row["lastactive"][:19] }}</td>
                </tr>
            {% endfor %}
        </tbody>
      </table>
    {% include "footer.html" %}
    <script>
        setTimeout(function () {
            location.reload();
        }, 10000);  // 10000 milliseconds = 10 seconds
       
    </script>
   
</body>
</html>